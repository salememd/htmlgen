<html xml:lang="en-ly" lang="en-ly" xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <title>Libya Guide</title>

    <link type="text/css" rel="stylesheet" href="js/jui/jui-theme.css?v=1.1" />
    <link type="text/css" rel="stylesheet" href="css/style.css?v=1.1" />
    <link type="text/css" rel="stylesheet" href="css/en.css?v=1.1" />

    <script src="js/jui/jui-core.js?v=1.1" type="text/javascript"></script>
    <style>
        .tree li {
            list-style: none;
        }
    </style>
    <script type="text/javascript">
        /* global app, webapp */

        var webapp = {

        };
        app.main = function() {
            new webapp.Login();
        };
    </script>

    <script src="js/jui/jui-icons.js?v=1.1" type="text/javascript"></script>
    <script src="js/jui/jui-components.js?v=1.1" type="text/javascript"></script>
    <script src="js/jui/jui-window.js?v=1.1" type="text/javascript"></script>
    <script src="js/jui/extra-components/jui-components.js?v=1.1" type="text/javascript"></script>
    <script src="js/jui/jui-data.js?v=1.1" type="text/javascript"></script>

    <script>
        (function() {


            jUI.Tree = function(pa) {
                if (pa && pa.__loading__) return;
                var newPa = app.$(app.clone(pa), {
                    className: "tree",
                    visible: true
                }, false);
                var el = document.createElement("ul");

                jUI.Layout.call(this, newPa, el);
            };

            (function() {
                jUI.Tree.prototype = new jUI.Layout({
                    __loading__: true
                });
                jUI.Tree.prototype.constructor = jUI.Tree;


                // Overriden Function Start ===========================================

                jUI.Tree.prototype._initProp = function(pa) {
                    jUI.Layout.prototype._initProp.call(this, pa);
                    this.__V.Tree = {
                        Nodes: []
                    };

                };

                jUI.Tree.prototype.leafs = function(nodes) {

                    this.__V.Tree.Nodes = nodes;


                    for (var i = 0; i < nodes.length; i++) {

                        nodes[i]._setTree(this);

                        this.__V.el.appendChild(nodes[i].__V.el);

                    }


                };




                jUI.Tree.prototype.getTreeLeafs = function() {
                    return this.__V.Tree.Nodes;
                };


                jUI.Tree.prototype.getSelectedNodes = function(nodes = this.__V.Tree.Nodes, set = []) {
                    var t = nodes;

                    for (var i = 0; i < t.length; i++) {
                        this.getSelectedNodes(t[i].__V.Node.childs, set);
                        if (t[i].__V.Node.selectDom.getChecked() == true && t[i].__V.Node.childs.length == 0) {
                            set.push(t[i]);
                        }


                    }


                    return set;
                };



                app.$(jUI.Tree.prototype.__props = app.clone(jUI.Tree.prototype.__props), {
                    leafs: "leafs"

                });

                jUI.Tree.prototype.__events = jUI.Tree.prototype.__events.clone().concat([
                    "onNodeSelectionChange",
                    "onViewStateChange"

                ]);

            })();
        })();



        /* 
		
		
		
		jUI Tree node 
		
		
		
		
		
		*/




        (function() {
            jUI.Tree.Node = function(pa) {
                if (pa && pa.__loading__) return;
                var newPa = app.$(app.clone(pa), {
                    className: "treenode",
                }, false);
                var el = document.createElement("li");

                jUI.Layout.call(this, newPa, el);
            };

            (function() {
                jUI.Tree.Node.prototype = new jUI.Layout({
                    __loading__: true
                });
                jUI.Tree.Node.prototype.constructor = jUI.Tree.Node;

                jUI.Tree.Node.prototype._initProp = function(pa) {
                    jUI.Layout.prototype._initProp.call(this, pa);
                    this.__V.Node = {
                        text: new jUI.Label({
                            classModifier: "nodetext",
                            text: "",
                            layout: jUI.Layout.ltFollowHor,
                            forId: ""
                        }),
                        isExpanded: false,
                        isSelectable: false,
                        childs: [],
                        treeObj: null,

                    };

                    this.addChildren([this.__V.Node.text]);
                    this.setVisible(true);
                    this.setLayout(jUI.Layout.ltFollowVer);


                };


                jUI.Tree.Node.prototype.setText = function(text) {
                    this.__V.Node.text.setText(text);

                }

                jUI.Tree.Node.prototype.getText = function() {
                    return this.__V.Node.text.getText();

                }

                /**
                Collapse or expand the node
				
                **/
                jUI.Tree.Node.prototype.setExpanded = function(isExpanded) {

                    if (this.__V.Node.childs.length > 0) {
                        this.__V.Node.isExpanded = isExpanded;

                        if (isExpanded == true) {
                            //this.__V.Node.expandDom.setChecked(true);
                            this.__V.Node.expandDom.__V.Checkbox.checked = true; // using setChecked method will trigger the onCheck event in check box,
                            this.__V.Node.expandDom.__V._IconLabelComponent.shape.$(this.__V.Node.selectDom.getCheckIcon());
                            this.__V.Node.expandDom._appendToClassName("checked");
                            this.__V.Node.subnodeDom.setVisible(true);

                        } else {
                            //this.__V.Node.expandDom.setChecked(false);

                            this.__V.Node.expandDom.__V.Checkbox.checked = false; // using setChecked method will trigger the onCheck event in check box,
                            this.__V.Node.expandDom.__V._IconLabelComponent.shape.$(this.__V.Node.selectDom._getClearIcon());
                            this.__V.Node.expandDom._removeFromClassName("checked");

                            this.__V.Node.subnodeDom.setVisible(false);

                        }
                    }


                }




                /**
                TreeView uses this method to attach it's own object with the node
				
                **/
                jUI.Tree.Node.prototype._setTree = function(tree) {

                    if (tree instanceof jUI.Tree) {

                        this.__V.Node.treeObj = tree;
                        for (var j = 0; j < this.__V.Node.childs.length; j++) {
                            this.__V.Node.childs[j]._setTree(tree);
                        }
                    }

                };

                /**
                select/unselect the node and all it's children	
				
				**/
                jUI.Tree.Node.prototype.setSelected = function(selected, node = this) {

                    var t = node.__V.Node.childs;

                    if (selected) {
                        if (t.length == 0) {
                            this.__V.Node.selectDom.__V.Checkbox.checked = true; // using setChecked method will trigger the check event in check box,
                            this.__V.Node.selectDom.__V._IconLabelComponent.shape.$(this.__V.Node.selectDom.getCheckIcon());
                            this.__V.Node.selectDom._appendToClassName("checked");
                            return;
                        }
                        for (var i = 0; i < t.length; i++) {
                            if (t[i].__V.Node.selectDom.getChecked() == false) {
                                this.setSelected(true, t[i]);
                                t[i].__V.Node.selectDom.__V.Checkbox.checked = true; // using setChecked method will trigger the check event in check box,
                                t[i].__V.Node.selectDom.__V._IconLabelComponent.shape.$(t[i].__V.Node.selectDom.getCheckIcon());
                                t[i].__V.Node.selectDom._appendToClassName("checked");


                            }
                        }


                    } else {

                        if (t.length == 0) {
                            this.__V.Node.selectDom.__V.Checkbox.checked = false; // using setChecked method will trigger the check event in check box,
                            this.__V.Node.selectDom.__V._IconLabelComponent.shape.$(this.__V.Node.selectDom._getClearIcon());
                            this.__V.Node.selectDom._removeFromClassName("checked");
                            return;
                        }

                        for (var i = 0; i < t.length; i++) {

                            if (t[i].__V.Node.selectDom.getChecked()) {
                                this.setSelected(false, t[i]);
                                t[i].__V.Node.selectDom.__V.Checkbox.checked = false; // using setChecked method will trigger the check event in check box,
                                t[i].__V.Node.selectDom.__V._IconLabelComponent.shape.$(t[i].__V.Node.selectDom._getClearIcon());
                                t[i].__V.Node.selectDom._removeFromClassName("checked");

                            }

                        }
                    }

                };



                // TO DO add child || multi children 
                jUI.Tree.Node.prototype.addChild = function(node) {

                    var childSet = [];

                    if (node instanceof Array) {
                        childSet = node;

                    } else if (node instanceof jUI.Tree.Node) {
                        childSet.push(node)

                    } else {
                        throw new Error("Uncomaptable");
                    }


                    if (childSet.length == 0) {
                        return;
                    }

                    if (typeof this.__V.Node.subnodeDom !== "undefined") {
                        this.__V.Node.subnodeDom.addChildren(childSet);
                        this.__V.Node.childs = this.__V.Node.childs.concat(childSet);
                        return;
                    }


                    this.__V.Node.childs = childSet;

                    var subnode = new jUI.Layout({
                        visible: true,
                        layout: jUI.Layout.ltFollowHor,

                    }, document.createElement("ul"));

                    var oj = this;

                    var toggle = new jUI.Checkbox({
                        checked: this.__V.Node.isExpanded,
                        layout: jUI.Layout.ltFollowHor,
                        readOnly: false,
                        label: "",
                        events: {
                            check: function(state) {
                                oj.setExpanded(state);
                                oj.__V.Node.treeObj._doEvent("onViewStateChange", oj);
                            }

                        }
                    });


                    subnode.addChildren(childSet);

                    this.__V.Node.subnodeDom = subnode;

                    this.__V.Node.expandDom = toggle;

                    this.addChildren([toggle, subnode]);
                    this.setExpanded(this.__V.Node.isExpanded);



                }


                /**
                control whether the node can be selected or not				
				
                **/
                jUI.Tree.Node.prototype.setSelectable = function(isSelectable) {

                    if (isSelectable == true && this.__V.Node.isSelectable == false) {
                        this.__V.Node.isSelectable = true;
                        var oj = this;

                        var select = new jUI.Checkbox({
                            checked: false,
                            readOnly: false,
                            layout: jUI.Layout.ltFollowHor,
                            label: "",
                            events: {
                                check: function(state) {

                                    oj.setSelected(state);

                                    oj.__V.Node.treeObj._doEvent("onNodeSelectionChange", oj);

                                    /**** DEBUG ****/
                                    var s = "";
                                    var obj = oj.__V.Node.treeObj;
                                    obj.getSelectedNodes().forEach(function(item) {
                                        s += item.__V.Node.text.__V.Label.text + ", ";
                                    });
                                    alert("Selected(for testing):" + s);
                                    /**************/
                                }

                            }
                        });

                        this.__V.Node.selectDom = select;
                        this.addChildren([select]);

                    } else if (isSelectable == false && this.__V.Node.isSelectable == true) {
                        this.__V.Node.selectDom.finalize();
                        this.__V.Node.isSelectable = false;

                    }

                }



                app.$(jUI.Tree.Node.prototype.__props = app.clone(jUI.Tree.Node.prototype.__props), {
                    text: "setText",
                    children: "addChild",
                    expanded: "setExpanded",
                    selectable: "setSelectable",
                });

                jUI.Tree.Node.prototype.__events = jUI.Tree.Node.prototype.__events.clone().concat([

                ]);


            })();
        })();




        /* global app, webapp, jUI */


        (function() {
            webapp.Login = function() {
                jUI.ViewController.call(this);
            };
            webapp.Login.prototype = new jUI.ViewController({
                __loading__: true
            });
            webapp.Login.prototype.constructor = webapp.Login;
            webapp.Login.prototype._initController = function() {
                this.viewDidLoad = function() {
                    this.view.show();

                };

            };



            webapp.Login.prototype._initView = function() {

                return new jUI.Window({
                    width: "100%",
                    height: "100%",
                    children: [

                        new jUI.Tree({
                            leafs: [
                                new jUI.Tree.Node({
                                    text: "a-f",
                                    selectable: true,
                                    children: [
                                        new jUI.Tree.Node({
                                            text: "a",
                                            selectable: true,
                                            children: []
                                        }),
                                        new jUI.Tree.Node({
                                            text: "b",
                                            selectable: true,
                                            children: []
                                        }),
                                        new jUI.Tree.Node({
                                            text: "c-f",
                                            selectable: true,
                                            children: [
                                                new jUI.Tree.Node({
                                                    text: "c",
                                                    selectable: true,
                                                    children: []
                                                }), new jUI.Tree.Node({
                                                    text: "d - f",
                                                    selectable: true,
                                                    children: [
                                                        new jUI.Tree.Node({
                                                            text: "d",
                                                            selectable: true,
                                                            children: []
                                                        }),
                                                        new jUI.Tree.Node({
                                                            text: "e",
                                                            selectable: true,
                                                            children: []
                                                        }),
                                                        new jUI.Tree.Node({
                                                            text: "f",
                                                            selectable: true,
                                                            children: []
                                                        }),
                                                    ]
                                                }),
                                            ],
                                            expanded: true,

                                        })
                                    ],
                                    expanded: true,

                                }),
                                new jUI.Tree.Node({
                                    text: "g",
                                    selectable: true,
                                    expanded: true,
                                    children: []
                                }),
                                new jUI.Tree.Node({
                                    text: "h",
                                    selectable: true,
                                    expanded: true,
                                    children: []
                                }),
                                new jUI.Tree.Node({
                                    text: "i - n",
                                    selectable: true,
                                    children: [
                                        new jUI.Tree.Node({
                                            text: "i",
                                            selectable: true,
                                            expanded: true,
                                            children: []
                                        }),
                                        new jUI.Tree.Node({
                                            text: "j",
                                            selectable: true,
                                            expanded: true,
                                            children: []
                                        }),
                                        new jUI.Tree.Node({
                                            text: "k - m",
                                            selectable: true,
                                            children: [
                                                new jUI.Tree.Node({
                                                    text: "k",
                                                    selectable: true,
                                                    expanded: true,
                                                    children: []
                                                }), new jUI.Tree.Node({
                                                    text: "l",
                                                    selectable: true,
                                                    expanded: true,
                                                    children: []
                                                }), new jUI.Tree.Node({
                                                    text: "m",
                                                    selectable: true,
                                                    expanded: true,
                                                    children: []
                                                })
                                            ],
                                            expanded: true,

                                        }),
                                        new jUI.Tree.Node({
                                            text: "n",
                                            selectable: true,
                                            children: []
                                        })

                                    ],
                                    expanded: true,

                                })


                            ],
                            events: {
                                onNodeSelectionChange: function(a) {
                                    alert("User onSelect event: " + a.getText());
                                },
                                onViewStateChange: function(a) {
                                    alert("User onCollaps/expand event: " + a.getText());
                                }
                            }
                        })

                    ]
                });
            };
        })();
    </script>


</head>

<body onload="void(0);">
</body>

</html>